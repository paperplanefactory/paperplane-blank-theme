function debounce(e,o){let t;return function(...n){clearTimeout(t),t=setTimeout(()=>e.apply(this,n),o)}}function getWordVariations(e){const o=new Set([e.toLowerCase()]),t=[{from:/i$/i,to:"o"},{from:/e$/i,to:"a"},{from:/i$/i,to:"e"},{from:/o$/i,to:"i"},{from:/a$/i,to:"e"},{from:/e$/i,to:"i"}],n=[{from:/chi$/i,to:"co"},{from:/che$/i,to:"ca"},{from:/ghi$/i,to:"go"},{from:/ghe$/i,to:"ga"},{from:/co$/i,to:"chi"},{from:/ca$/i,to:"che"},{from:/go$/i,to:"ghi"},{from:/ga$/i,to:"ghe"}];return[...t,...n].forEach(t=>{e.match(t.from)&&o.add(e.replace(t.from,t.to).toLowerCase())}),Array.from(o)}function handleExceptions(e){const o={uomo:"uomini",uomini:"uomo",dio:"dei",dei:"dio",bue:"buoi",buoi:"bue"},t=new Set(["città","virtù","gioventù","caffè","computer","sport"]);return t.has(e.toLowerCase())?[e.toLowerCase()]:o[e.toLowerCase()]?[e.toLowerCase(),o[e.toLowerCase()]]:null}function getNormalizedWords(e){const o=e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase(),t=handleExceptions(o);return t||getWordVariations(o)}function removeAccents(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}document.addEventListener("DOMContentLoaded",function(){function e(e){const o=searchConfig.postTypePriorities||{},t=parseInt(o[e])||999;return t}async function o(){try{if(searchConfig.gzipUrl)try{const e=await fetch(searchConfig.gzipUrl,{headers:{"Accept-Encoding":"gzip"}});if(e.ok)return await e.json()}catch(e){console.warn("Fallback alla versione non compressa:",e)}const e=await fetch(searchConfig.jsonUrl);if(!e.ok)throw new Error("Errore nel caricamento del JSON");return await e.json()}catch(e){throw console.error("Errore nel caricamento:",e),e}}let t=[];const n=document.getElementById("search-input"),r=document.getElementById("search-suggestions");let i=!1;n&&r&&n&&r?(n.addEventListener("focus",function(){i||o().then(e=>{t=Object.values(e),i=!0}).catch(e=>{console.error("Errore caricamento dati:",e)})}),n.addEventListener("input",debounce(function(o){const n=o.target.value.toLowerCase();if(n.length<3)return void r.classList.remove("visible");const i=t.filter(e=>{const o=n.split(" ").filter(e=>e.length>0),t=o.map(e=>getNormalizedWords(e)).flat();e.matchScore=0;const r=o.some(o=>removeAccents(e.title.toLowerCase()).includes(o.toLowerCase()));r&&(e.matchScore+=100);const i=t.some(o=>removeAccents(e.title.toLowerCase()).includes(o));i&&!r&&(e.matchScore+=50);const c=e.searchable_content&&o.some(o=>removeAccents(e.searchable_content.toLowerCase()).includes(o.toLowerCase()));c&&(e.matchScore+=30);const a=e.searchable_content&&t.some(o=>removeAccents(e.searchable_content.toLowerCase()).includes(o));return a&&!c&&(e.matchScore+=10),i||a||r||c}).sort((o,t)=>{const n=e(o.post_type),r=e(t.post_type);return n!==r?n-r:o.matchScore!==t.matchScore?t.matchScore-o.matchScore:new Date(t.modified)-new Date(o.modified)}).slice(0,30);i.length>0?(r.innerHTML=i.map(e=>`\n                <div class="suggestion-item">\n                    ${e.featured_image?`<div class="suggestion-image">\n                            <img src="${e.featured_image}" alt="" loading="lazy" decoding="async" />\n                        </div>`:""}\n                    <div class="suggestion-title">${e.title}</div>\n                    <a href="${e.url}" class="absl">\n                        <span class="screen-reader-text">${e.title}</span>\n                    </a>\n                </div>\n            `).join(""),r.classList.add("visible")):r.classList.remove("visible")},300)),document.addEventListener("click",function(e){!r||n.contains(e.target)||r.contains(e.target)||r.classList.remove("visible")}),r.addEventListener("focusout",function(e){r.contains(e.relatedTarget)||r.classList.remove("visible")})):console.error("Elementi di ricerca non trovati")});